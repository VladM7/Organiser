"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.exactDevDeps = exports.devDeps = exports.deps = exports.default = void 0;
exports.siblingDep = siblingDep;

require("source-map-support/register");

var _asyncOra = require("@electron-forge/async-ora");

var _debug = _interopRequireDefault(require("debug"));

var _fsExtra = _interopRequireDefault(require("fs-extra"));

var _path = _interopRequireDefault(require("path"));

var _installDependencies = _interopRequireWildcard(require("../../util/install-dependencies"));

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:init:npm');

const corePackage = _fsExtra.default.readJsonSync(_path.default.resolve(__dirname, '../../../package.json'));

function siblingDep(name) {
  return `@electron-forge/${name}@^${corePackage.version}`;
}

const deps = ['electron-squirrel-startup'];
exports.deps = deps;
const devDeps = [siblingDep('cli'), siblingDep('maker-squirrel'), siblingDep('maker-zip'), siblingDep('maker-deb'), siblingDep('maker-rpm')];
exports.devDeps = devDeps;
const exactDevDeps = ['electron'];
exports.exactDevDeps = exactDevDeps;

var _default = async dir => {
  await (0, _asyncOra.asyncOra)('Installing NPM Dependencies', async () => {
    d('installing dependencies');
    await (0, _installDependencies.default)(dir, deps);
    d('installing devDependencies');
    await (0, _installDependencies.default)(dir, devDeps, _installDependencies.DepType.DEV);
    d('installing exact devDependencies');

    for (const packageName of exactDevDeps) {
      await (0, _installDependencies.default)(dir, [packageName], _installDependencies.DepType.DEV, _installDependencies.DepVersionRestriction.EXACT);
    }
  });
};

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hcGkvaW5pdC1zY3JpcHRzL2luaXQtbnBtLnRzIl0sIm5hbWVzIjpbImQiLCJjb3JlUGFja2FnZSIsImZzIiwicmVhZEpzb25TeW5jIiwicGF0aCIsInJlc29sdmUiLCJfX2Rpcm5hbWUiLCJzaWJsaW5nRGVwIiwibmFtZSIsInZlcnNpb24iLCJkZXBzIiwiZGV2RGVwcyIsImV4YWN0RGV2RGVwcyIsImRpciIsIkRlcFR5cGUiLCJERVYiLCJwYWNrYWdlTmFtZSIsIkRlcFZlcnNpb25SZXN0cmljdGlvbiIsIkVYQUNUIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7Ozs7Ozs7O0FBRUEsTUFBTUEsQ0FBQyxHQUFHLG9CQUFNLHlCQUFOLENBQVY7O0FBQ0EsTUFBTUMsV0FBVyxHQUFHQyxpQkFBR0MsWUFBSCxDQUFnQkMsY0FBS0MsT0FBTCxDQUFhQyxTQUFiLEVBQXdCLHVCQUF4QixDQUFoQixDQUFwQjs7QUFFTyxTQUFTQyxVQUFULENBQW9CQyxJQUFwQixFQUEwQztBQUMvQyxTQUFRLG1CQUFrQkEsSUFBSyxLQUFJUCxXQUFXLENBQUNRLE9BQVEsRUFBdkQ7QUFDRDs7QUFFTSxNQUFNQyxJQUFJLEdBQUcsQ0FBQywyQkFBRCxDQUFiOztBQUNBLE1BQU1DLE9BQU8sR0FBRyxDQUFDSixVQUFVLENBQUMsS0FBRCxDQUFYLEVBQW9CQSxVQUFVLENBQUMsZ0JBQUQsQ0FBOUIsRUFBa0RBLFVBQVUsQ0FBQyxXQUFELENBQTVELEVBQTJFQSxVQUFVLENBQUMsV0FBRCxDQUFyRixFQUFvR0EsVUFBVSxDQUFDLFdBQUQsQ0FBOUcsQ0FBaEI7O0FBQ0EsTUFBTUssWUFBWSxHQUFHLENBQUMsVUFBRCxDQUFyQjs7O2VBRVEsTUFBT0MsR0FBUCxJQUFzQztBQUNuRCxRQUFNLHdCQUFTLDZCQUFULEVBQXdDLFlBQVk7QUFDeERiLElBQUFBLENBQUMsQ0FBQyx5QkFBRCxDQUFEO0FBQ0EsVUFBTSxrQ0FBZWEsR0FBZixFQUFvQkgsSUFBcEIsQ0FBTjtBQUVBVixJQUFBQSxDQUFDLENBQUMsNEJBQUQsQ0FBRDtBQUNBLFVBQU0sa0NBQWVhLEdBQWYsRUFBb0JGLE9BQXBCLEVBQTZCRyw2QkFBUUMsR0FBckMsQ0FBTjtBQUVBZixJQUFBQSxDQUFDLENBQUMsa0NBQUQsQ0FBRDs7QUFDQSxTQUFLLE1BQU1nQixXQUFYLElBQTBCSixZQUExQixFQUF3QztBQUN0QyxZQUFNLGtDQUFlQyxHQUFmLEVBQW9CLENBQUNHLFdBQUQsQ0FBcEIsRUFBbUNGLDZCQUFRQyxHQUEzQyxFQUFnREUsMkNBQXNCQyxLQUF0RSxDQUFOO0FBQ0Q7QUFDRixHQVhLLENBQU47QUFZRCxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYXN5bmNPcmEgfSBmcm9tICdAZWxlY3Ryb24tZm9yZ2UvYXN5bmMtb3JhJztcbmltcG9ydCBkZWJ1ZyBmcm9tICdkZWJ1Zyc7XG5pbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbmltcG9ydCBpbnN0YWxsRGVwTGlzdCwgeyBEZXBUeXBlLCBEZXBWZXJzaW9uUmVzdHJpY3Rpb24gfSBmcm9tICcuLi8uLi91dGlsL2luc3RhbGwtZGVwZW5kZW5jaWVzJztcblxuY29uc3QgZCA9IGRlYnVnKCdlbGVjdHJvbi1mb3JnZTppbml0Om5wbScpO1xuY29uc3QgY29yZVBhY2thZ2UgPSBmcy5yZWFkSnNvblN5bmMocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uLy4uLy4uL3BhY2thZ2UuanNvbicpKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHNpYmxpbmdEZXAobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGBAZWxlY3Ryb24tZm9yZ2UvJHtuYW1lfUBeJHtjb3JlUGFja2FnZS52ZXJzaW9ufWA7XG59XG5cbmV4cG9ydCBjb25zdCBkZXBzID0gWydlbGVjdHJvbi1zcXVpcnJlbC1zdGFydHVwJ107XG5leHBvcnQgY29uc3QgZGV2RGVwcyA9IFtzaWJsaW5nRGVwKCdjbGknKSwgc2libGluZ0RlcCgnbWFrZXItc3F1aXJyZWwnKSwgc2libGluZ0RlcCgnbWFrZXItemlwJyksIHNpYmxpbmdEZXAoJ21ha2VyLWRlYicpLCBzaWJsaW5nRGVwKCdtYWtlci1ycG0nKV07XG5leHBvcnQgY29uc3QgZXhhY3REZXZEZXBzID0gWydlbGVjdHJvbiddO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyAoZGlyOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgYXdhaXQgYXN5bmNPcmEoJ0luc3RhbGxpbmcgTlBNIERlcGVuZGVuY2llcycsIGFzeW5jICgpID0+IHtcbiAgICBkKCdpbnN0YWxsaW5nIGRlcGVuZGVuY2llcycpO1xuICAgIGF3YWl0IGluc3RhbGxEZXBMaXN0KGRpciwgZGVwcyk7XG5cbiAgICBkKCdpbnN0YWxsaW5nIGRldkRlcGVuZGVuY2llcycpO1xuICAgIGF3YWl0IGluc3RhbGxEZXBMaXN0KGRpciwgZGV2RGVwcywgRGVwVHlwZS5ERVYpO1xuXG4gICAgZCgnaW5zdGFsbGluZyBleGFjdCBkZXZEZXBlbmRlbmNpZXMnKTtcbiAgICBmb3IgKGNvbnN0IHBhY2thZ2VOYW1lIG9mIGV4YWN0RGV2RGVwcykge1xuICAgICAgYXdhaXQgaW5zdGFsbERlcExpc3QoZGlyLCBbcGFja2FnZU5hbWVdLCBEZXBUeXBlLkRFViwgRGVwVmVyc2lvblJlc3RyaWN0aW9uLkVYQUNUKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdfQ==