"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _asyncOra = require("@electron-forge/async-ora");

var _child_process = require("child_process");

var _debug = _interopRequireDefault(require("debug"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:init:git');

var _default = async dir => {
  await (0, _asyncOra.asyncOra)('Initializing Git Repository', async () => {
    await new Promise((resolve, reject) => {
      (0, _child_process.exec)('git rev-parse --show-toplevel', {
        cwd: dir
      }, err => {
        if (err) {
          // not run within a Git repository
          d('executing "git init" in directory:', dir);
          (0, _child_process.exec)('git init', {
            cwd: dir
          }, initErr => initErr ? reject(initErr) : resolve());
        } else {
          d('.git directory already exists, skipping git initialization');
          resolve();
        }
      });
    });
  });
};

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hcGkvaW5pdC1zY3JpcHRzL2luaXQtZ2l0LnRzIl0sIm5hbWVzIjpbImQiLCJkaXIiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImN3ZCIsImVyciIsImluaXRFcnIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBRUEsTUFBTUEsQ0FBQyxHQUFHLG9CQUFNLHlCQUFOLENBQVY7O2VBRWUsTUFBT0MsR0FBUCxJQUF1QjtBQUNwQyxRQUFNLHdCQUFTLDZCQUFULEVBQXdDLFlBQVk7QUFDeEQsVUFBTSxJQUFJQyxPQUFKLENBQWtCLENBQUNDLE9BQUQsRUFBVUMsTUFBVixLQUFxQjtBQUMzQywrQkFBSywrQkFBTCxFQUFzQztBQUNwQ0MsUUFBQUEsR0FBRyxFQUFFSjtBQUQrQixPQUF0QyxFQUVJSyxHQUFELElBQVM7QUFDVixZQUFJQSxHQUFKLEVBQVM7QUFDUDtBQUNBTixVQUFBQSxDQUFDLENBQUMsb0NBQUQsRUFBdUNDLEdBQXZDLENBQUQ7QUFDQSxtQ0FBSyxVQUFMLEVBQWlCO0FBQUVJLFlBQUFBLEdBQUcsRUFBRUo7QUFBUCxXQUFqQixFQUFnQ00sT0FBRCxJQUFjQSxPQUFPLEdBQUdILE1BQU0sQ0FBQ0csT0FBRCxDQUFULEdBQXFCSixPQUFPLEVBQWhGO0FBQ0QsU0FKRCxNQUlPO0FBQ0xILFVBQUFBLENBQUMsQ0FBQyw0REFBRCxDQUFEO0FBQ0FHLFVBQUFBLE9BQU87QUFDUjtBQUNGLE9BWEQ7QUFZRCxLQWJLLENBQU47QUFjRCxHQWZLLENBQU47QUFnQkQsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFzeW5jT3JhIH0gZnJvbSAnQGVsZWN0cm9uLWZvcmdlL2FzeW5jLW9yYSc7XG5pbXBvcnQgeyBleGVjIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgZGVidWcgZnJvbSAnZGVidWcnO1xuXG5jb25zdCBkID0gZGVidWcoJ2VsZWN0cm9uLWZvcmdlOmluaXQ6Z2l0Jyk7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChkaXI6IHN0cmluZykgPT4ge1xuICBhd2FpdCBhc3luY09yYSgnSW5pdGlhbGl6aW5nIEdpdCBSZXBvc2l0b3J5JywgYXN5bmMgKCkgPT4ge1xuICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGV4ZWMoJ2dpdCByZXYtcGFyc2UgLS1zaG93LXRvcGxldmVsJywge1xuICAgICAgICBjd2Q6IGRpcixcbiAgICAgIH0sIChlcnIpID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIC8vIG5vdCBydW4gd2l0aGluIGEgR2l0IHJlcG9zaXRvcnlcbiAgICAgICAgICBkKCdleGVjdXRpbmcgXCJnaXQgaW5pdFwiIGluIGRpcmVjdG9yeTonLCBkaXIpO1xuICAgICAgICAgIGV4ZWMoJ2dpdCBpbml0JywgeyBjd2Q6IGRpciB9LCAoaW5pdEVycikgPT4gKGluaXRFcnIgPyByZWplY3QoaW5pdEVycikgOiByZXNvbHZlKCkpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkKCcuZ2l0IGRpcmVjdG9yeSBhbHJlYWR5IGV4aXN0cywgc2tpcHBpbmcgZ2l0IGluaXRpYWxpemF0aW9uJyk7XG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59O1xuIl19