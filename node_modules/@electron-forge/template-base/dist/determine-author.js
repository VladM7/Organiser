"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _debug = _interopRequireDefault(require("debug"));

var _crossSpawnPromise = require("@malept/cross-spawn-promise");

var _username = _interopRequireDefault(require("username"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:determine-author');

async function getGitConfig(name, cwd) {
  const value = await (0, _crossSpawnPromise.spawn)('git', ['config', '--get', name], {
    cwd
  });
  return value.trim();
}

const getAuthorFromGitConfig = async dir => {
  try {
    const name = await getGitConfig('user.name', dir);
    const email = await getGitConfig('user.email', dir);
    return {
      name,
      email
    };
  } catch (err) {
    d('Error when getting git config:', err);
    return undefined;
  }
};

var _default = async dir => (await getAuthorFromGitConfig(dir)) || (0, _username.default)();

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9kZXRlcm1pbmUtYXV0aG9yLnRzIl0sIm5hbWVzIjpbImQiLCJnZXRHaXRDb25maWciLCJuYW1lIiwiY3dkIiwidmFsdWUiLCJ0cmltIiwiZ2V0QXV0aG9yRnJvbUdpdENvbmZpZyIsImRpciIsImVtYWlsIiwiZXJyIiwidW5kZWZpbmVkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFFQTs7QUFDQTs7OztBQUVBLE1BQU1BLENBQUMsR0FBRyxvQkFBTSxpQ0FBTixDQUFWOztBQUVBLGVBQWVDLFlBQWYsQ0FBNEJDLElBQTVCLEVBQTBDQyxHQUExQyxFQUF3RTtBQUN0RSxRQUFNQyxLQUFLLEdBQUcsTUFBTSw4QkFBTSxLQUFOLEVBQWEsQ0FBQyxRQUFELEVBQVcsT0FBWCxFQUFvQkYsSUFBcEIsQ0FBYixFQUF3QztBQUFFQyxJQUFBQTtBQUFGLEdBQXhDLENBQXBCO0FBQ0EsU0FBT0MsS0FBSyxDQUFDQyxJQUFOLEVBQVA7QUFDRDs7QUFFRCxNQUFNQyxzQkFBc0IsR0FBRyxNQUFPQyxHQUFQLElBQStDO0FBQzVFLE1BQUk7QUFDRixVQUFNTCxJQUFJLEdBQUcsTUFBTUQsWUFBWSxDQUFDLFdBQUQsRUFBY00sR0FBZCxDQUEvQjtBQUNBLFVBQU1DLEtBQUssR0FBRyxNQUFNUCxZQUFZLENBQUMsWUFBRCxFQUFlTSxHQUFmLENBQWhDO0FBQ0EsV0FBTztBQUFFTCxNQUFBQSxJQUFGO0FBQVFNLE1BQUFBO0FBQVIsS0FBUDtBQUNELEdBSkQsQ0FJRSxPQUFPQyxHQUFQLEVBQVk7QUFDWlQsSUFBQUEsQ0FBQyxDQUFDLGdDQUFELEVBQW1DUyxHQUFuQyxDQUFEO0FBQ0EsV0FBT0MsU0FBUDtBQUNEO0FBQ0YsQ0FURDs7ZUFXZSxNQUFPSCxHQUFQLElBQStDLENBQUMsTUFBTUQsc0JBQXNCLENBQUNDLEdBQUQsQ0FBN0IsS0FBdUMsd0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVidWcgZnJvbSAnZGVidWcnO1xuaW1wb3J0IHsgUGFja2FnZVBlcnNvbiB9IGZyb20gJ0BlbGVjdHJvbi1mb3JnZS9zaGFyZWQtdHlwZXMnO1xuaW1wb3J0IHsgc3Bhd24gfSBmcm9tICdAbWFsZXB0L2Nyb3NzLXNwYXduLXByb21pc2UnO1xuaW1wb3J0IHVzZXJuYW1lIGZyb20gJ3VzZXJuYW1lJztcblxuY29uc3QgZCA9IGRlYnVnKCdlbGVjdHJvbi1mb3JnZTpkZXRlcm1pbmUtYXV0aG9yJyk7XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEdpdENvbmZpZyhuYW1lOiBzdHJpbmcsIGN3ZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgdmFsdWUgPSBhd2FpdCBzcGF3bignZ2l0JywgWydjb25maWcnLCAnLS1nZXQnLCBuYW1lXSwgeyBjd2QgfSk7XG4gIHJldHVybiB2YWx1ZS50cmltKCk7XG59XG5cbmNvbnN0IGdldEF1dGhvckZyb21HaXRDb25maWcgPSBhc3luYyAoZGlyOiBzdHJpbmcpOiBQcm9taXNlPFBhY2thZ2VQZXJzb24+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBuYW1lID0gYXdhaXQgZ2V0R2l0Q29uZmlnKCd1c2VyLm5hbWUnLCBkaXIpO1xuICAgIGNvbnN0IGVtYWlsID0gYXdhaXQgZ2V0R2l0Q29uZmlnKCd1c2VyLmVtYWlsJywgZGlyKTtcbiAgICByZXR1cm4geyBuYW1lLCBlbWFpbCB9O1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBkKCdFcnJvciB3aGVuIGdldHRpbmcgZ2l0IGNvbmZpZzonLCBlcnIpO1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChkaXI6IHN0cmluZyk6IFByb21pc2U8UGFja2FnZVBlcnNvbj4gPT4gKGF3YWl0IGdldEF1dGhvckZyb21HaXRDb25maWcoZGlyKSkgfHwgdXNlcm5hbWUoKTtcbiJdfQ==