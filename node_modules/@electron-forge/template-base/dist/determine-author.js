"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _child_process = _interopRequireDefault(require("child_process"));

var _debug = _interopRequireDefault(require("debug"));

var _util = require("util");

var _username = _interopRequireDefault(require("username"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const d = (0, _debug.default)('electron-forge:determine-author');
const exec = (0, _util.promisify)(_child_process.default.exec);

const execAndTrimResult = async (command, dir) => {
  const {
    stdout
  } = await exec(command, {
    cwd: dir
  });
  return stdout.trim();
};

const getAuthorFromGitConfig = async dir => {
  try {
    const name = await execAndTrimResult('git config --get user.name', dir);
    const email = await execAndTrimResult('git config --get user.email', dir);
    return {
      name,
      email
    };
  } catch (err) {
    d('Error when getting git config:', err);
    return undefined;
  }
};

var _default = async dir => (await getAuthorFromGitConfig(dir)) || (0, _username.default)();

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9kZXRlcm1pbmUtYXV0aG9yLnRzIl0sIm5hbWVzIjpbImQiLCJleGVjIiwiY2hpbGRQcm9jZXNzIiwiZXhlY0FuZFRyaW1SZXN1bHQiLCJjb21tYW5kIiwiZGlyIiwic3Rkb3V0IiwiY3dkIiwidHJpbSIsImdldEF1dGhvckZyb21HaXRDb25maWciLCJuYW1lIiwiZW1haWwiLCJlcnIiLCJ1bmRlZmluZWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUVBOztBQUNBOzs7O0FBRUEsTUFBTUEsQ0FBQyxHQUFHLG9CQUFNLGlDQUFOLENBQVY7QUFDQSxNQUFNQyxJQUFJLEdBQUcscUJBQVVDLHVCQUFhRCxJQUF2QixDQUFiOztBQUVBLE1BQU1FLGlCQUFpQixHQUFHLE9BQU9DLE9BQVAsRUFBd0JDLEdBQXhCLEtBQXdDO0FBQ2hFLFFBQU07QUFBRUMsSUFBQUE7QUFBRixNQUFhLE1BQU1MLElBQUksQ0FBQ0csT0FBRCxFQUFVO0FBQUVHLElBQUFBLEdBQUcsRUFBRUY7QUFBUCxHQUFWLENBQTdCO0FBQ0EsU0FBT0MsTUFBTSxDQUFDRSxJQUFQLEVBQVA7QUFDRCxDQUhEOztBQUtBLE1BQU1DLHNCQUFzQixHQUFHLE1BQU9KLEdBQVAsSUFBK0M7QUFDNUUsTUFBSTtBQUNGLFVBQU1LLElBQUksR0FBRyxNQUFNUCxpQkFBaUIsQ0FBQyw0QkFBRCxFQUErQkUsR0FBL0IsQ0FBcEM7QUFDQSxVQUFNTSxLQUFLLEdBQUcsTUFBTVIsaUJBQWlCLENBQUMsNkJBQUQsRUFBZ0NFLEdBQWhDLENBQXJDO0FBQ0EsV0FBTztBQUFFSyxNQUFBQSxJQUFGO0FBQVFDLE1BQUFBO0FBQVIsS0FBUDtBQUNELEdBSkQsQ0FJRSxPQUFPQyxHQUFQLEVBQVk7QUFDWlosSUFBQUEsQ0FBQyxDQUFDLGdDQUFELEVBQW1DWSxHQUFuQyxDQUFEO0FBQ0EsV0FBT0MsU0FBUDtBQUNEO0FBQ0YsQ0FURDs7ZUFXZSxNQUFPUixHQUFQLElBQXVCLENBQUMsTUFBTUksc0JBQXNCLENBQUNKLEdBQUQsQ0FBN0IsS0FBdUMsd0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2hpbGRQcm9jZXNzIGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IGRlYnVnIGZyb20gJ2RlYnVnJztcbmltcG9ydCB7IFBhY2thZ2VQZXJzb24gfSBmcm9tICdAZWxlY3Ryb24tZm9yZ2Uvc2hhcmVkLXR5cGVzJztcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gJ3V0aWwnO1xuaW1wb3J0IHVzZXJuYW1lIGZyb20gJ3VzZXJuYW1lJztcblxuY29uc3QgZCA9IGRlYnVnKCdlbGVjdHJvbi1mb3JnZTpkZXRlcm1pbmUtYXV0aG9yJyk7XG5jb25zdCBleGVjID0gcHJvbWlzaWZ5KGNoaWxkUHJvY2Vzcy5leGVjKTtcblxuY29uc3QgZXhlY0FuZFRyaW1SZXN1bHQgPSBhc3luYyAoY29tbWFuZDogc3RyaW5nLCBkaXI6IHN0cmluZykgPT4ge1xuICBjb25zdCB7IHN0ZG91dCB9ID0gYXdhaXQgZXhlYyhjb21tYW5kLCB7IGN3ZDogZGlyIH0pO1xuICByZXR1cm4gc3Rkb3V0LnRyaW0oKTtcbn07XG5cbmNvbnN0IGdldEF1dGhvckZyb21HaXRDb25maWcgPSBhc3luYyAoZGlyOiBzdHJpbmcpOiBQcm9taXNlPFBhY2thZ2VQZXJzb24+ID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBuYW1lID0gYXdhaXQgZXhlY0FuZFRyaW1SZXN1bHQoJ2dpdCBjb25maWcgLS1nZXQgdXNlci5uYW1lJywgZGlyKTtcbiAgICBjb25zdCBlbWFpbCA9IGF3YWl0IGV4ZWNBbmRUcmltUmVzdWx0KCdnaXQgY29uZmlnIC0tZ2V0IHVzZXIuZW1haWwnLCBkaXIpO1xuICAgIHJldHVybiB7IG5hbWUsIGVtYWlsIH07XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGQoJ0Vycm9yIHdoZW4gZ2V0dGluZyBnaXQgY29uZmlnOicsIGVycik7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKGRpcjogc3RyaW5nKSA9PiAoYXdhaXQgZ2V0QXV0aG9yRnJvbUdpdENvbmZpZyhkaXIpKSB8fCB1c2VybmFtZSgpO1xuIl19