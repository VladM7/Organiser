"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.BaseTemplate = void 0;

require("source-map-support/register");

var _asyncOra = require("@electron-forge/async-ora");

var _debug = _interopRequireDefault(require("debug"));

var _fsExtra = _interopRequireDefault(require("fs-extra"));

var _path = _interopRequireDefault(require("path"));

var _determineAuthor = _interopRequireDefault(require("./determine-author"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

const currentForgeVersion = require('../package.json').version;

const d = (0, _debug.default)('electron-forge:template:base');

const tmplDir = _path.default.resolve(__dirname, '../tmpl');

class BaseTemplate {
  constructor() {
    _defineProperty(this, "templateDir", tmplDir);

    _defineProperty(this, "requiredForgeVersion", currentForgeVersion);
  }

  get devDependencies() {
    const packageJSONPath = _path.default.join(this.templateDir, 'package.json');

    if (_fsExtra.default.pathExistsSync(packageJSONPath)) {
      const packageDevDeps = _fsExtra.default.readJsonSync(packageJSONPath).devDependencies;

      if (packageDevDeps) {
        return Object.entries(packageDevDeps).map(([packageName, version]) => {
          if (version === 'ELECTRON_FORGE/VERSION') {
            version = currentForgeVersion;
          }

          return `${packageName}@${version}`;
        });
      }
    }

    return [];
  }

  async initializeTemplate(directory, {
    copyCIFiles
  }) {
    await (0, _asyncOra.asyncOra)('Copying Starter Files', async () => {
      d('creating directory:', _path.default.resolve(directory, 'src'));
      await _fsExtra.default.mkdirs(_path.default.resolve(directory, 'src'));
      const rootFiles = ['_gitignore'];
      if (copyCIFiles) rootFiles.push(...['_travis.yml', '_appveyor.yml']);
      const srcFiles = ['index.css', 'index.js', 'index.html'];

      for (const file of rootFiles) {
        await this.copy(_path.default.resolve(tmplDir, file), _path.default.resolve(directory, file.replace(/^_/, '.')));
      }

      for (const file of srcFiles) {
        await this.copy(_path.default.resolve(tmplDir, file), _path.default.resolve(directory, 'src', file));
      }
    });
    await this.initializePackageJSON(directory);
  }

  async copy(source, target) {
    d(`copying "${source}" --> "${target}"`);
    await _fsExtra.default.copy(source, target);
  }

  async copyTemplateFile(destDir, basename) {
    await this.copy(_path.default.join(this.templateDir, basename), _path.default.resolve(destDir, basename));
  }

  async initializePackageJSON(directory) {
    await (0, _asyncOra.asyncOra)('Initializing NPM Module', async () => {
      const packageJSON = await _fsExtra.default.readJson(_path.default.resolve(__dirname, '../tmpl/package.json')); // eslint-disable-next-line no-multi-assign

      packageJSON.productName = packageJSON.name = _path.default.basename(directory).toLowerCase();
      packageJSON.author = await (0, _determineAuthor.default)(directory);
      packageJSON.scripts.lint = 'echo "No linting configured"';
      d('writing package.json to:', directory);
      await _fsExtra.default.writeJson(_path.default.resolve(directory, 'package.json'), packageJSON, {
        spaces: 2
      });
    });
  }

  async updateFileByLine(inputPath, lineHandler, outputPath) {
    const fileContents = (await _fsExtra.default.readFile(inputPath, 'utf8')).split('\n').map(lineHandler).join('\n');
    await _fsExtra.default.writeFile(outputPath || inputPath, fileContents);

    if (outputPath !== undefined) {
      await _fsExtra.default.remove(inputPath);
    }
  }

}

exports.BaseTemplate = BaseTemplate;

var _default = new BaseTemplate();

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9CYXNlVGVtcGxhdGUudHMiXSwibmFtZXMiOlsiY3VycmVudEZvcmdlVmVyc2lvbiIsInJlcXVpcmUiLCJ2ZXJzaW9uIiwiZCIsInRtcGxEaXIiLCJwYXRoIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsIkJhc2VUZW1wbGF0ZSIsImRldkRlcGVuZGVuY2llcyIsInBhY2thZ2VKU09OUGF0aCIsImpvaW4iLCJ0ZW1wbGF0ZURpciIsImZzIiwicGF0aEV4aXN0c1N5bmMiLCJwYWNrYWdlRGV2RGVwcyIsInJlYWRKc29uU3luYyIsIk9iamVjdCIsImVudHJpZXMiLCJtYXAiLCJwYWNrYWdlTmFtZSIsImluaXRpYWxpemVUZW1wbGF0ZSIsImRpcmVjdG9yeSIsImNvcHlDSUZpbGVzIiwibWtkaXJzIiwicm9vdEZpbGVzIiwicHVzaCIsInNyY0ZpbGVzIiwiZmlsZSIsImNvcHkiLCJyZXBsYWNlIiwiaW5pdGlhbGl6ZVBhY2thZ2VKU09OIiwic291cmNlIiwidGFyZ2V0IiwiY29weVRlbXBsYXRlRmlsZSIsImRlc3REaXIiLCJiYXNlbmFtZSIsInBhY2thZ2VKU09OIiwicmVhZEpzb24iLCJwcm9kdWN0TmFtZSIsIm5hbWUiLCJ0b0xvd2VyQ2FzZSIsImF1dGhvciIsInNjcmlwdHMiLCJsaW50Iiwid3JpdGVKc29uIiwic3BhY2VzIiwidXBkYXRlRmlsZUJ5TGluZSIsImlucHV0UGF0aCIsImxpbmVIYW5kbGVyIiwib3V0cHV0UGF0aCIsImZpbGVDb250ZW50cyIsInJlYWRGaWxlIiwic3BsaXQiLCJ3cml0ZUZpbGUiLCJ1bmRlZmluZWQiLCJyZW1vdmUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUVBOztBQUNBOztBQUVBOzs7Ozs7QUFFQSxNQUFNQSxtQkFBbUIsR0FBR0MsT0FBTyxDQUFDLGlCQUFELENBQVAsQ0FBMkJDLE9BQXZEOztBQUVBLE1BQU1DLENBQUMsR0FBRyxvQkFBTSw4QkFBTixDQUFWOztBQUNBLE1BQU1DLE9B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LEVBQXNDRyxZQUF0QyxDQUFOOztBQUNBLFFBQUlELFVBQVUsS0FBS0ssU0FBbkIsRUFBOEI7QUFDNUIsWUFBTTFDLGlCQUFHMkMsTUFBSCxDQUFVUixTQUFWLENBQU47QUFDRDtBQUNGOztBQTFFZ0Q7Ozs7ZUE2RXBDLElBQUl4QyxZQUFKLEUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhc3luY09yYSB9IGZyb20gJ0BlbGVjdHJvbi1mb3JnZS9hc3luYy1vcmEnO1xuaW1wb3J0IGRlYnVnIGZyb20gJ2RlYnVnJztcbmltcG9ydCB7IEZvcmdlVGVtcGxhdGUsIEluaXRUZW1wbGF0ZU9wdGlvbnMgfSBmcm9tICdAZWxlY3Ryb24tZm9yZ2Uvc2hhcmVkLXR5cGVzJztcbmltcG9ydCBmcyBmcm9tICdmcy1leHRyYSc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuaW1wb3J0IGRldGVybWluZUF1dGhvciBmcm9tICcuL2RldGVybWluZS1hdXRob3InO1xuXG5jb25zdCBjdXJyZW50Rm9yZ2VWZXJzaW9uID0gcmVxdWlyZSgnLi4vcGFja2FnZS5qc29uJykudmVyc2lvbjtcblxuY29uc3QgZCA9IGRlYnVnKCdlbGVjdHJvbi1mb3JnZTp0ZW1wbGF0ZTpiYXNlJyk7XG5jb25zdCB0bXBsRGlyID0gcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uL3RtcGwnKTtcblxuZXhwb3J0IGNsYXNzIEJhc2VUZW1wbGF0ZSBpbXBsZW1lbnRzIEZvcmdlVGVtcGxhdGUge1xuICBwdWJsaWMgdGVtcGxhdGVEaXIgPSB0bXBsRGlyO1xuXG4gIHB1YmxpYyByZXF1aXJlZEZvcmdlVmVyc2lvbiA9IGN1cnJlbnRGb3JnZVZlcnNpb247XG5cbiAgZ2V0IGRldkRlcGVuZGVuY2llcygpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcGFja2FnZUpTT05QYXRoID0gcGF0aC5qb2luKHRoaXMudGVtcGxhdGVEaXIsICdwYWNrYWdlLmpzb24nKTtcbiAgICBpZiAoZnMucGF0aEV4aXN0c1N5bmMocGFja2FnZUpTT05QYXRoKSkge1xuICAgICAgY29uc3QgcGFja2FnZURldkRlcHMgPSBmcy5yZWFkSnNvblN5bmMocGFja2FnZUpTT05QYXRoKS5kZXZEZXBlbmRlbmNpZXM7XG4gICAgICBpZiAocGFja2FnZURldkRlcHMpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5lbnRyaWVzKHBhY2thZ2VEZXZEZXBzKS5tYXAoKFtwYWNrYWdlTmFtZSwgdmVyc2lvbl0pID0+IHtcbiAgICAgICAgICBpZiAodmVyc2lvbiA9PT0gJ0VMRUNUUk9OX0ZPUkdFL1ZFUlNJT04nKSB7XG4gICAgICAgICAgICB2ZXJzaW9uID0gY3VycmVudEZvcmdlVmVyc2lvbjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGAke3BhY2thZ2VOYW1lfUAke3ZlcnNpb259YDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGluaXRpYWxpemVUZW1wbGF0ZShkaXJlY3Rvcnk6IHN0cmluZywgeyBjb3B5Q0lGaWxlcyB9OiBJbml0VGVtcGxhdGVPcHRpb25zKSB7XG4gICAgYXdhaXQgYXN5bmNPcmEoJ0NvcHlpbmcgU3RhcnRlciBGaWxlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGQoJ2NyZWF0aW5nIGRpcmVjdG9yeTonLCBwYXRoLnJlc29sdmUoZGlyZWN0b3J5LCAnc3JjJykpO1xuICAgICAgYXdhaXQgZnMubWtkaXJzKHBhdGgucmVzb2x2ZShkaXJlY3RvcnksICdzcmMnKSk7XG4gICAgICBjb25zdCByb290RmlsZXMgPSBbJ19naXRpZ25vcmUnXTtcbiAgICAgIGlmIChjb3B5Q0lGaWxlcykgcm9vdEZpbGVzLnB1c2goLi4uWydfdHJhdmlzLnltbCcsICdfYXBwdmV5b3IueW1sJ10pO1xuICAgICAgY29uc3Qgc3JjRmlsZXMgPSBbJ2luZGV4LmNzcycsICdpbmRleC5qcycsICdpbmRleC5odG1sJ107XG5cbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiByb290RmlsZXMpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5jb3B5KHBhdGgucmVzb2x2ZSh0bXBsRGlyLCBmaWxlKSwgcGF0aC5yZXNvbHZlKGRpcmVjdG9yeSwgZmlsZS5yZXBsYWNlKC9eXy8sICcuJykpKTtcbiAgICAgIH1cbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBzcmNGaWxlcykge1xuICAgICAgICBhd2FpdCB0aGlzLmNvcHkocGF0aC5yZXNvbHZlKHRtcGxEaXIsIGZpbGUpLCBwYXRoLnJlc29sdmUoZGlyZWN0b3J5LCAnc3JjJywgZmlsZSkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplUGFja2FnZUpTT04oZGlyZWN0b3J5KTtcbiAgfVxuXG4gIGFzeW5jIGNvcHkoc291cmNlOiBzdHJpbmcsIHRhcmdldDogc3RyaW5nKSB7XG4gICAgZChgY29weWluZyBcIiR7c291cmNlfVwiIC0tPiBcIiR7dGFyZ2V0fVwiYCk7XG4gICAgYXdhaXQgZnMuY29weShzb3VyY2UsIHRhcmdldCk7XG4gIH1cblxuICBhc3luYyBjb3B5VGVtcGxhdGVGaWxlKGRlc3REaXI6IHN0cmluZywgYmFzZW5hbWU6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuY29weShwYXRoLmpvaW4odGhpcy50ZW1wbGF0ZURpciEsIGJhc2VuYW1lKSwgcGF0aC5yZXNvbHZlKGRlc3REaXIsIGJhc2VuYW1lKSk7XG4gIH1cblxuICBhc3luYyBpbml0aWFsaXplUGFja2FnZUpTT04oZGlyZWN0b3J5OiBzdHJpbmcpIHtcbiAgICBhd2FpdCBhc3luY09yYSgnSW5pdGlhbGl6aW5nIE5QTSBNb2R1bGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYWNrYWdlSlNPTiA9IGF3YWl0IGZzLnJlYWRKc29uKHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLi90bXBsL3BhY2thZ2UuanNvbicpKTtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1tdWx0aS1hc3NpZ25cbiAgICAgIHBhY2thZ2VKU09OLnByb2R1Y3ROYW1lID0gcGFja2FnZUpTT04ubmFtZSA9IHBhdGguYmFzZW5hbWUoZGlyZWN0b3J5KS50b0xvd2VyQ2FzZSgpO1xuICAgICAgcGFja2FnZUpTT04uYXV0aG9yID0gYXdhaXQgZGV0ZXJtaW5lQXV0aG9yKGRpcmVjdG9yeSk7XG5cbiAgICAgIHBhY2thZ2VKU09OLnNjcmlwdHMubGludCA9ICdlY2hvIFwiTm8gbGludGluZyBjb25maWd1cmVkXCInO1xuXG4gICAgICBkKCd3cml0aW5nIHBhY2thZ2UuanNvbiB0bzonLCBkaXJlY3RvcnkpO1xuICAgICAgYXdhaXQgZnMud3JpdGVKc29uKHBhdGgucmVzb2x2ZShkaXJlY3RvcnksICdwYWNrYWdlLmpzb24nKSwgcGFja2FnZUpTT04sIHsgc3BhY2VzOiAyIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlRmlsZUJ5TGluZShcbiAgICBpbnB1dFBhdGg6IHN0cmluZyxcbiAgICBsaW5lSGFuZGxlcjogKGxpbmU6IHN0cmluZykgPT4gc3RyaW5nLFxuICAgIG91dHB1dFBhdGg/OiBzdHJpbmcgfCB1bmRlZmluZWQsXG4gICkge1xuICAgIGNvbnN0IGZpbGVDb250ZW50cyA9IChhd2FpdCBmcy5yZWFkRmlsZShpbnB1dFBhdGgsICd1dGY4JykpLnNwbGl0KCdcXG4nKS5tYXAobGluZUhhbmRsZXIpLmpvaW4oJ1xcbicpO1xuICAgIGF3YWl0IGZzLndyaXRlRmlsZShvdXRwdXRQYXRoIHx8IGlucHV0UGF0aCwgZmlsZUNvbnRlbnRzKTtcbiAgICBpZiAob3V0cHV0UGF0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBhd2FpdCBmcy5yZW1vdmUoaW5wdXRQYXRoKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IEJhc2VUZW1wbGF0ZSgpO1xuIl19